

<!DOCTYPE html>
<html lang="en">

<head>
  
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title> utils/timeInterpolation.test.js</title>

  <script src="https://cdn.jsdelivr.net/gh/google/code-prettify@master/loader/run_prettify.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  <!-- build/entry.js removed - not needed -->
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
  <![endif]-->
  <link href="https://fonts.googleapis.com/css?family=Roboto:100,400,700|Inconsolata,700" rel="stylesheet">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
  <link type="text/css" rel="stylesheet" href="https://jmblog.github.io/color-themes-for-google-code-prettify/themes/tomorrow-night.min.css">
  <link type="text/css" rel="stylesheet" href="styles/app.min.css">
  <link type="text/css" rel="stylesheet" href="styles/iframe.css">
  <link type="text/css" rel="stylesheet" href="">
  <script async defer src="https://buttons.github.io/buttons.js"></script>

  
</head>



<body class="layout small-header">
    <div id="stickyNavbarOverlay"></div>
    

<div class="top-nav">
    <div class="inner">
        <a id="hamburger" role="button" class="navbar-burger" aria-label="menu" aria-expanded="false">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
        </a>
        <div class="logo">
            
            
        </div>
        <div class="menu">
            
            <div class="navigation">
                <a
                    href="index.html"
                    class="link"
                >
                    Documentation
                </a>
                
                
                
            </div>
        </div>
    </div>
</div>
    <div id="main">
        <div
            class="sidebar "
            id="sidebarNav"
        >
            
            <nav>
                
                    <h2><a href="index.html">Documentation</a></h2><div class="category"><h3>Modules</h3><ul><li><a href="module-Context_ThemeContext.html">Context/ThemeContext</a></li><li><a href="module-analyzeGroupsAndPublish.html">analyzeGroupsAndPublish</a></li><li><a href="module-axisBuilder.html">axisBuilder</a></li><li><a href="module-axisCalculator.html">axisCalculator</a></li><li><a href="module-calculateAndPublishMaxYAxes.html">calculateAndPublishMaxYAxes</a></li><li><a href="module-chartAxisAlignment.html">chartAxisAlignment</a></li><li><a href="module-chartComponent.html">chartComponent</a></li><li><a href="module-chartManager.html">chartManager</a></li><li><a href="module-chartUpdateHelpers.html">chartUpdateHelpers</a></li><li><a href="module-components_AnalysisSidebar.html">components/AnalysisSidebar</a></li><li><a href="module-components_ChannelList.html">components/ChannelList</a></li><li><a href="module-components_ComputedChannelsSidebar.html">components/ComputedChannelsSidebar</a></li><li><a href="module-components_DeltaDrawer.html">components/DeltaDrawer</a></li><li><a href="module-components_DeltaTable.html">components/DeltaTable</a></li><li><a href="module-components_DeltaTableDataFormatter.html">components/DeltaTableDataFormatter</a></li><li><a href="module-components_DeltaTableRenderer.html">components/DeltaTableRenderer</a></li><li><a href="module-components_EquationEvaluatorInChannelList.html">components/EquationEvaluatorInChannelList</a></li><li><a href="module-components_PolarChart.html">components/PolarChart</a></li><li><a href="module-components_PolarChartCanvas.html">components/PolarChartCanvas</a></li><li><a href="module-components_ProgressBar.html">components/ProgressBar</a></li><li><a href="module-components_ResizableGroup.html">components/ResizableGroup</a></li><li><a href="module-components_SidebarResizer.html">components/SidebarResizer</a></li><li><a href="module-components_Tooltip.html">components/Tooltip</a></li><li><a href="module-components_debugPanelLite.html">components/debugPanelLite</a></li><li><a href="module-components_renderComputedChart.html">components/renderComputedChart</a></li><li><a href="module-components_renderComtradeCharts.html">components/renderComtradeCharts</a></li><li><a href="module-components_renderDigitalCharts.html">components/renderDigitalCharts</a></li><li><a href="module-components_renderSingleAnalogChart.html">components/renderSingleAnalogChart</a></li><li><a href="module-components_renderSingleDigitalChart.html">components/renderSingleDigitalChart</a></li><li><a href="module-components_setupPolarChartIntegration.html">components/setupPolarChartIntegration</a></li><li><a href="module-components_showError.html">components/showError</a></li><li><a href="module-components_verticalLineControl.html">components/verticalLineControl</a></li><li><a href="module-comtradeUtils.html">comtradeUtils</a></li><li><a href="module-createDragBar.html">createDragBar</a></li><li><a href="module-createState.html">createState</a></li><li><a href="module-domUpdateQueue.html">domUpdateQueue</a></li><li><a href="module-domUpdateQueueInit.html">domUpdateQueueInit</a></li><li><a href="module-eventListenerManager.html">eventListenerManager</a></li><li><a href="module-handleVerticalLineShortcuts.html">handleVerticalLineShortcuts</a></li><li><a href="module-initVerticalLineControl.html">initVerticalLineControl</a></li><li><a href="module-main.html">main</a></li><li><a href="module-maxYAxesStore.html">maxYAxesStore</a></li><li><a href="module-mergerWindowLauncher.html">mergerWindowLauncher</a></li><li><a href="module-plugins_autoUnitScalePlugin.html">plugins/autoUnitScalePlugin</a></li><li><a href="module-plugins_axisLinesPlugin.html">plugins/axisLinesPlugin</a></li><li><a href="module-plugins_deltaBoxPlugin.html">plugins/deltaBoxPlugin</a></li><li><a href="module-plugins_horizontalZoomPanPlugin.html">plugins/horizontalZoomPanPlugin</a></li><li><a href="module-plugins_verticalLinePlugin.html">plugins/verticalLinePlugin</a></li><li><a href="module-seriesMapper.html">seriesMapper</a></li><li><a href="module-services_computedChannels.html">services/computedChannels</a></li><li><a href="module-services_computedChannels_dataPreparation.html">services/computedChannels/dataPreparation</a></li><li><a href="module-services_computedChannels_eventHandling.html">services/computedChannels/eventHandling</a></li><li><a href="module-services_computedChannels_expressionConversion.html">services/computedChannels/expressionConversion</a></li><li><a href="module-services_computedChannels_resultProcessing.html">services/computedChannels/resultProcessing</a></li><li><a href="module-services_computedChannels_stateUpdate.html">services/computedChannels/stateUpdate</a></li><li><a href="module-services_computedChannels_validators.html">services/computedChannels/validators</a></li><li><a href="module-services_computedChannels_workerManagement.html">services/computedChannels/workerManagement</a></li><li><a href="module-setupChartDragAndDrop.html">setupChartDragAndDrop</a></li><li><a href="module-timeInterpolation.html">timeInterpolation</a></li><li><a href="module-utils_autoGroupChannels.html">utils/autoGroupChannels</a></li><li><a href="module-utils_chartDomUtils.html">utils/chartDomUtils</a></li><li><a href="module-utils_chartMetadataStore.html">utils/chartMetadataStore</a></li><li><a href="module-utils_computedChannelMetadata.html">utils/computedChannelMetadata</a></li><li><a href="module-utils_constants.html">utils/constants</a></li><li><a href="module-utils_helpers.html">utils/helpers</a></li><li><a href="module-utils_sidebarStore.html">utils/sidebarStore</a></li><li><a href="module-workers_computedChannelWorker.html">workers/computedChannelWorker</a></li></ul><h3>Classes</h3><ul><li><a href="module-components_PolarChartCanvas.PolarChartCanvas.html">PolarChartCanvas</a></li><li><a href="module-utils_computedChannelMetadata-ComputedChannelMetadata.html">ComputedChannelMetadata</a></li></ul><h3>Global</h3><ul><li><a href="global.html#IMPLEMENTATION_COMPLETE">IMPLEMENTATION_COMPLETE</a></li><li><a href="global.html#QUICK_REFERENCE">QUICK_REFERENCE</a></li><li><a href="global.html#STORAGE_CFG_KEY">STORAGE_CFG_KEY</a></li><li><a href="global.html#ZOOM_ICONS">ZOOM_ICONS</a></li><li><a href="global.html#adjustMainContent">adjustMainContent</a></li><li><a href="global.html#appendComputedChannelToStorage">appendComputedChannelToStorage</a></li><li><a href="global.html#applyZoom">applyZoom</a></li><li><a href="global.html#attachChartContainer">attachChartContainer</a></li><li><a href="global.html#attachChartEventHandlers">attachChartEventHandlers</a></li><li><a href="global.html#attachChartPlugins">attachChartPlugins</a></li><li><a href="global.html#attachComputedChartContainer">attachComputedChartContainer</a></li><li><a href="global.html#attachComputedChartEventHandlers">attachComputedChartEventHandlers</a></li><li><a href="global.html#attachComputedChartPlugins">attachComputedChartPlugins</a></li><li><a href="global.html#broadcastComputedChannelChange">broadcastComputedChannelChange</a></li><li><a href="global.html#buildChartData">buildChartData</a></li><li><a href="global.html#buildChartOptions">buildChartOptions</a></li><li><a href="global.html#buildComputedChannelLabels">buildComputedChannelLabels</a></li><li><a href="global.html#buildComputedChartOptions">buildComputedChartOptions</a></li><li><a href="global.html#buildGroupsWithAutoGrouping">buildGroupsWithAutoGrouping</a></li><li><a href="global.html#buildGroupsWithUserAssignments">buildGroupsWithUserAssignments</a></li><li><a href="global.html#buildUnitChartData">buildUnitChartData</a></li><li><a href="global.html#calculateStats">calculateStats</a></li><li><a href="global.html#chart2">chart2</a></li><li><a href="global.html#cleanupOldComputedCharts">cleanupOldComputedCharts</a></li><li><a href="global.html#clearChartsContainer">clearChartsContainer</a></li><li><a href="global.html#clearComputedChannelsFromStorage">clearComputedChannelsFromStorage</a></li><li><a href="global.html#clearExpressionCache">clearExpressionCache</a></li><li><a href="global.html#closeAnalysisDrawer">closeAnalysisDrawer</a></li><li><a href="global.html#collectChartDeltas">collectChartDeltas</a></li><li><a href="global.html#computeChartDataDimensions">computeChartDataDimensions</a></li><li><a href="global.html#createBinaryBlob">createBinaryBlob</a></li><li><a href="global.html#createChannelList">createChannelList</a></li><li><a href="global.html#createChartMetadata">createChartMetadata</a></li><li><a href="global.html#createChartOptions">createChartOptions</a></li><li><a href="global.html#createComputedChartMetadata">createComputedChartMetadata</a></li><li><a href="global.html#createComputedClickHandler">createComputedClickHandler</a></li><li><a href="global.html#createComputedMousemoveHandler">createComputedMousemoveHandler</a></li><li><a href="global.html#createDigitalFillPlugin">createDigitalFillPlugin</a></li><li><a href="global.html#createGroupDragBar">createGroupDragBar</a></li><li><a href="global.html#createMousemoveHandler">createMousemoveHandler</a></li><li><a href="global.html#createScopeTemplate">createScopeTemplate</a></li><li><a href="global.html#createState">createState</a></li><li><a href="global.html#createVerticalLineClickHandler">createVerticalLineClickHandler</a></li><li><a href="global.html#createZoomControlsHTML">createZoomControlsHTML</a></li><li><a href="global.html#debounce">debounce</a></li><li><a href="global.html#deleteComputedChannelFromStorage">deleteComputedChannelFromStorage</a></li><li><a href="global.html#encodeFloat64">encodeFloat64</a></li><li><a href="global.html#encodeInt32">encodeInt32</a></li><li><a href="global.html#evaluateExpression">evaluateExpression</a></li><li><a href="global.html#exportAllChannelsAsCSV">exportAllChannelsAsCSV</a></li><li><a href="global.html#exportComputedChannelsAsCSV">exportComputedChannelsAsCSV</a></li><li><a href="global.html#extractChannelMetadata">extractChannelMetadata</a></li><li><a href="global.html#extractChannelNameFromEquation">extractChannelNameFromEquation</a></li><li><a href="global.html#extractGroupId">extractGroupId</a></li><li><a href="global.html#extractMathExpression">extractMathExpression</a></li><li><a href="global.html#filterGroupsWithChannels">filterGroupsWithChannels</a></li><li><a href="global.html#filterUnassignedComputedChannels">filterUnassignedComputedChannels</a></li><li><a href="global.html#filterValidIndices">filterValidIndices</a></li><li><a href="global.html#formatEquationForLatex">formatEquationForLatex</a></li><li><a href="global.html#formatScaledValue">formatScaledValue</a></li><li><a href="global.html#generateCFGContentBinary32">generateCFGContentBinary32</a></li><li><a href="global.html#generateCFGContentBinary64">generateCFGContentBinary64</a></li><li><a href="global.html#generateCFGContentFloat32">generateCFGContentFloat32</a></li><li><a href="global.html#generateCFGContentFloat64">generateCFGContentFloat64</a></li><li><a href="global.html#generateDATContentBinary32">generateDATContentBinary32</a></li><li><a href="global.html#generateDATContentBinary64">generateDATContentBinary64</a></li><li><a href="global.html#generateDATContentFloat32">generateDATContentFloat32</a></li><li><a href="global.html#generateDATContentFloat64">generateDATContentFloat64</a></li><li><a href="global.html#getCacheStats">getCacheStats</a></li><li><a href="global.html#getChannelByDisplayName">getChannelByDisplayName</a></li><li><a href="global.html#getChannelMetadata">getChannelMetadata</a></li><li><a href="global.html#getChannelsForFile">getChannelsForFile</a></li><li><a href="global.html#getCompiledExpression">getCompiledExpression</a></li><li><a href="global.html#getComputedChannelById">getComputedChannelById</a></li><li><a href="global.html#getComputedChannelStorageMetadata">getComputedChannelStorageMetadata</a></li><li><a href="global.html#getComputedChannelsState">getComputedChannelsState</a></li><li><a href="global.html#getElementWidth">getElementWidth</a></li><li><a href="global.html#getFileIndexForTime">getFileIndexForTime</a></li><li><a href="global.html#getOriginalChannelName">getOriginalChannelName</a></li><li><a href="global.html#getSampleIndexInFile">getSampleIndexInFile</a></li><li><a href="global.html#getZoomLevel">getZoomLevel</a></li><li><a href="global.html#groupChannelsByUnit">groupChannelsByUnit</a></li><li><a href="global.html#handleComputedVerticalLineAddition">handleComputedVerticalLineAddition</a></li><li><a href="global.html#handleVerticalLineAddition">handleVerticalLineAddition</a></li><li><a href="global.html#hasStoredComputedChannels">hasStoredComputedChannels</a></li><li><a href="global.html#initComputedChannelsState">initComputedChannelsState</a></li><li><a href="global.html#initializeChartInstance">initializeChartInstance</a></li><li><a href="global.html#initializeComputedChartInstance">initializeComputedChartInstance</a></li><li><a href="global.html#initializeSidebarChannels">initializeSidebarChannels</a></li><li><a href="global.html#initializeZoomControls">initializeZoomControls</a></li><li><a href="global.html#injectZoomControls">injectZoomControls</a></li><li><a href="global.html#isMathJaxLoaded">isMathJaxLoaded</a></li><li><a href="global.html#listenForComputedChannelChanges">listenForComputedChannelChanges</a></li><li><a href="global.html#loadComputedChannelsForGroup">loadComputedChannelsForGroup</a></li><li><a href="global.html#loadComputedChannelsFromStorage">loadComputedChannelsFromStorage</a></li><li><a href="global.html#loadMathJax">loadMathJax</a></li><li><a href="global.html#mathJaxPromise">mathJaxPromise</a></li><li><a href="global.html#measurePerformance">measurePerformance</a></li><li><a href="global.html#mergeAnalogAndComputedMetadata">mergeAnalogAndComputedMetadata</a></li><li><a href="global.html#mergeAnalogChannels">mergeAnalogChannels</a></li><li><a href="global.html#mergeComtradeFilesSetsSequential">mergeComtradeFilesSetsSequential</a></li><li><a href="global.html#mergeDigitalChannels">mergeDigitalChannels</a></li><li><a href="global.html#mergeTimeArraysSequential">mergeTimeArraysSequential</a></li><li><a href="global.html#openAnalysisDrawer">openAnalysisDrawer</a></li><li><a href="global.html#openBothSidebars">openBothSidebars</a></li><li><a href="global.html#openDeltaWindow">openDeltaWindow</a></li><li><a href="global.html#openPhasorDiagram">openPhasorDiagram</a></li><li><a href="global.html#prepareChartDataContext">prepareChartDataContext</a></li><li><a href="global.html#processEquationInput">processEquationInput</a></li><li><a href="global.html#renameChannelWithPrefix">renameChannelWithPrefix</a></li><li><a href="global.html#renderChannelLabelContainer">renderChannelLabelContainer</a></li><li><a href="global.html#renderComputedChannels">renderComputedChannels</a></li><li><a href="global.html#renderLatex">renderLatex</a></li><li><a href="global.html#resetZoom">resetZoom</a></li><li><a href="global.html#resizeChartsToContainers">resizeChartsToContainers</a></li><li><a href="global.html#resolveGroupIndices">resolveGroupIndices</a></li><li><a href="global.html#resolveTimeArray">resolveTimeArray</a></li><li><a href="global.html#saveComputedChannelsToStorage">saveComputedChannelsToStorage</a></li><li><a href="global.html#setZoomLevel">setZoomLevel</a></li><li><a href="global.html#setupMobileSidebar">setupMobileSidebar</a></li><li><a href="global.html#showChannelListWindow">showChannelListWindow</a></li><li><a href="global.html#showFileInfo">showFileInfo</a></li><li><a href="global.html#subscribeChartUpdates">subscribeChartUpdates</a></li><li><a href="global.html#syncComputedChannelsWithParent">syncComputedChannelsWithParent</a></li><li><a href="global.html#toggleChartsVisibility">toggleChartsVisibility</a></li><li><a href="global.html#updateComputedChannelGroupInStorage">updateComputedChannelGroupInStorage</a></li><li><a href="global.html#updateComputedChannelInStorage">updateComputedChannelInStorage</a></li><li><a href="global.html#updateFileInfo">updateFileInfo</a></li><li><a href="global.html#updateMainZoomPosition">updateMainZoomPosition</a></li><li><a href="global.html#updateStatsCards">updateStatsCards</a></li><li><a href="global.html#updateZoomDisplay">updateZoomDisplay</a></li><li><a href="global.html#validateChannelName">validateChannelName</a></li><li><a href="global.html#validateGroupIndices">validateGroupIndices</a></li><li><a href="global.html#wrapChartInSection">wrapChartInSection</a></li><li><a href="global.html#zoomIn">zoomIn</a></li><li><a href="global.html#zoomOut">zoomOut</a></li></ul></div>
                
            </nav>
        </div>
        <div class="core" id="main-content-wrapper">
            <div class="content">
                <header class="page-title">
                    <p>Source</p>
                    <h1>utils/timeInterpolation.test.js</h1>
                </header>
                



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>/**
 * @file timeInterpolation.test.js
 * @description Test suite for time interpolation module
 * Run with: node timeInterpolation.test.js
 */

import {
  findSamplingRateForSample,
  calculateTimeFromSampleNumber,
  linearInterpolate,
  generateUniformTimeArray,
  interpolateData,
  compareTimestamps,
  detectUniformSpacing,
} from "./timeInterpolation.js";

// Color codes for console output
const colors = {
  reset: "\x1b[0m",
  green: "\x1b[32m",
  red: "\x1b[31m",
  yellow: "\x1b[33m",
  blue: "\x1b[36m",
};

function assert(condition, testName) {
  if (condition) {
    console.log(`${colors.green}âœ“${colors.reset} ${testName}`);
    return true;
  } else {
    console.log(`${colors.red}âœ—${colors.reset} ${testName}`);
    return false;
  }
}

function testSection(title) {
  console.log(`\n${colors.blue}â”â”â” ${title} â”â”â”${colors.reset}`);
}

// ============================================================================
// TEST 1: findSamplingRateForSample
// ============================================================================
testSection("TEST 1: findSamplingRateForSample");

let passed = 0;
let total = 0;

// Test 1.1: Single sampling rate
total++;
const samplingRates1 = [{ rate: 4000, endSample: 99999 }];
const rate1 = findSamplingRateForSample(100, samplingRates1);
if (
  assert(rate1 === 4000, "1.1 - Single rate: sample 100 should return 4000 Hz")
)
  passed++;

// Test 1.2: Multiple sampling rates
total++;
const samplingRates2 = [
  { rate: 4000, endSample: 10000 },
  { rate: 1000, endSample: 20000 },
  { rate: 500, endSample: 99999 },
];
const rate2a = findSamplingRateForSample(5000, samplingRates2);
if (
  assert(
    rate2a === 4000,
    "1.2a - Multiple rates: sample 5000 should return 4000 Hz"
  )
)
  passed++;

total++;
const rate2b = findSamplingRateForSample(15000, samplingRates2);
if (
  assert(
    rate2b === 1000,
    "1.2b - Multiple rates: sample 15000 should return 1000 Hz"
  )
)
  passed++;

total++;
const rate2c = findSamplingRateForSample(25000, samplingRates2);
if (
  assert(
    rate2c === 500,
    "1.2c - Multiple rates: sample 25000 should return 500 Hz"
  )
)
  passed++;

// ============================================================================
// TEST 2: calculateTimeFromSampleNumber
// ============================================================================
testSection("TEST 2: calculateTimeFromSampleNumber");

// Test 2.1: Basic calculation (4000 Hz)
total++;
const time0 = calculateTimeFromSampleNumber(0, [
  { rate: 4000, endSample: 99999 },
]);
if (
  assert(Math.abs(time0 - 0) &lt; 0.000001, "2.1a - Sample 0 should be 0 seconds")
)
  passed++;

total++;
const time1 = calculateTimeFromSampleNumber(1, [
  { rate: 4000, endSample: 99999 },
]);
const expected1 = 1 / 4000; // 0.00025
if (
  assert(
    Math.abs(time1 - expected1) &lt; 0.000001,
    `2.1b - Sample 1 should be ${expected1} seconds`
  )
)
  passed++;

total++;
const time100 = calculateTimeFromSampleNumber(100, [
  { rate: 4000, endSample: 99999 },
]);
const expected100 = 100 / 4000; // 0.025
if (
  assert(
    Math.abs(time100 - expected100) &lt; 0.000001,
    `2.1c - Sample 100 should be ${expected100} seconds`
  )
)
  passed++;

// Test 2.2: Different sampling rate (1000 Hz)
total++;
const time1_1kHz = calculateTimeFromSampleNumber(1000, [
  { rate: 1000, endSample: 99999 },
]);
const expected1kHz = 1000 / 1000; // 1.0
if (
  assert(
    Math.abs(time1_1kHz - expected1kHz) &lt; 0.000001,
    `2.2 - Sample 1000 at 1000 Hz should be ${expected1kHz} seconds`
  )
)
  passed++;

// ============================================================================
// TEST 3: linearInterpolate
// ============================================================================
testSection("TEST 3: linearInterpolate");

// Test 3.1: Basic interpolation
total++;
const interp1 = linearInterpolate(0, 10, 4, 20, 2);
if (
  assert(
    Math.abs(interp1 - 15) &lt; 0.000001,
    "3.1 - Interpolate at midpoint: should be 15"
  )
)
  passed++;

// Test 3.2: Quarter point
total++;
const interp2 = linearInterpolate(0, 10, 4, 20, 1);
if (
  assert(
    Math.abs(interp2 - 12.5) &lt; 0.000001,
    "3.2 - Interpolate at 1/4: should be 12.5"
  )
)
  passed++;

// Test 3.3: Three-quarter point
total++;
const interp3 = linearInterpolate(0, 10, 4, 20, 3);
if (
  assert(
    Math.abs(interp3 - 17.5) &lt; 0.000001,
    "3.3 - Interpolate at 3/4: should be 17.5"
  )
)
  passed++;

// Test 3.4: Edge case - x1 == x2
total++;
const interp4 = linearInterpolate(5, 10, 5, 20, 5);
if (assert(interp4 === 10, "3.4 - Edge case x1==x2: should return y1"))
  passed++;

// ============================================================================
// TEST 4: generateUniformTimeArray
// ============================================================================
testSection("TEST 4: generateUniformTimeArray");

// Test 4.1: Generate 10 samples at 4000 Hz
total++;
const timeArray = generateUniformTimeArray(10, [
  { rate: 4000, endSample: 99999 },
]);
if (assert(timeArray.length === 10, "4.1a - Should generate 10 time points"))
  passed++;

total++;
if (
  assert(Math.abs(timeArray[0] - 0) &lt; 0.000001, "4.1b - First time should be 0")
)
  passed++;

total++;
const expectedTime9 = 9 / 4000;
if (
  assert(
    Math.abs(timeArray[9] - expectedTime9) &lt; 0.000001,
    `4.1c - Last time should be ${expectedTime9}`
  )
)
  passed++;

// Test 4.2: Check uniform spacing
total++;
const intervals = [];
for (let i = 1; i &lt; timeArray.length; i++) {
  intervals.push(timeArray[i] - timeArray[i - 1]);
}
const avgInterval = 1 / 4000;
let uniformSpacing = intervals.every(
  (interval) => Math.abs(interval - avgInterval) &lt; 0.000001
);
if (
  assert(
    uniformSpacing,
    "4.2 - All intervals should be uniform (0.00025 seconds)"
  )
)
  passed++;

// ============================================================================
// TEST 5: interpolateData
// ============================================================================
testSection("TEST 5: interpolateData");

// Test 5.1: Interpolate simple data
total++;
const origTimes = [0, 1, 2];
const origData = [10, 15, 20];
const newTimes = [0, 0.5, 1, 1.5, 2];
const interpData = interpolateData(origTimes, origData, newTimes);

if (
  assert(interpData.length === 5, "5.1a - Should return 5 interpolated values")
)
  passed++;

total++;
if (
  assert(
    Math.abs(interpData[0] - 10) &lt; 0.000001,
    "5.1b - First value should be 10"
  )
)
  passed++;

total++;
if (
  assert(
    Math.abs(interpData[1] - 12.5) &lt; 0.000001,
    "5.1c - Value at 0.5 should be 12.5"
  )
)
  passed++;

total++;
if (
  assert(
    Math.abs(interpData[2] - 15) &lt; 0.000001,
    "5.1d - Value at 1 should be 15"
  )
)
  passed++;

// ============================================================================
// TEST 6: compareTimestamps
// ============================================================================
testSection("TEST 6: compareTimestamps");

// Test 6.1: Compare uniform vs non-uniform timestamps
total++;
const fileTs = [0, 1, 2, 6, 7, 8, 10];
const calcTs = [0, 0.00025, 0.0005, 0.00075, 0.001, 0.00125, 0.0015];
const comparison = compareTimestamps(fileTs, calcTs);

if (assert(comparison.hasGaps === true, "6.1a - Should detect gaps")) passed++;

total++;
if (assert(comparison.maxGap > 5, "6.1b - Max gap should be significant (> 5)"))
  passed++;

// ============================================================================
// TEST 7: detectUniformSpacing
// ============================================================================
testSection("TEST 7: detectUniformSpacing");

// Test 7.1: Uniform spacing
total++;
const uniformTimes = [0, 0.00025, 0.0005, 0.00075, 0.001];
const uniformAnalysis = detectUniformSpacing(uniformTimes);

if (
  assert(
    uniformAnalysis.isUniform === true,
    "7.1a - Should detect uniform spacing"
  )
)
  passed++;

total++;
if (
  assert(
    Math.abs(uniformAnalysis.avgInterval - 0.00025) &lt; 0.000001,
    "7.1b - Average interval should be 0.00025"
  )
)
  passed++;

// Test 7.2: Non-uniform spacing
total++;
const nonUniformTimes = [0, 0.001, 0.002, 0.006, 0.007];
const nonUniformAnalysis = detectUniformSpacing(nonUniformTimes);

if (
  assert(
    nonUniformAnalysis.isUniform === false,
    "7.2 - Should detect non-uniform spacing"
  )
)
  passed++;

// ============================================================================
// SUMMARY
// ============================================================================
testSection("TEST SUMMARY");

const percentage = ((passed / total) * 100).toFixed(1);
console.log(
  `\n${colors.blue}Total Tests: ${passed}/${total} (${percentage}%)${colors.reset}`
);

if (passed === total) {
  console.log(`${colors.green}All tests passed! âœ“${colors.reset}\n`);
} else {
  console.log(
    `${colors.yellow}${total - passed} test(s) failed${colors.reset}\n`
  );
}

// ============================================================================
// PRACTICAL EXAMPLE: COMTRADE Data Simulation
// ============================================================================
testSection("PRACTICAL EXAMPLE: COMTRADE Simulation");

console.log("\nðŸ“Š Simulating COMTRADE data with 4000 Hz sampling rate:");

const cfg = {
  analogChannels: [
    { id: "IA", unit: "A" },
    { id: "IB", unit: "A" },
    { id: "IC", unit: "A" },
  ],
  samplingRates: [{ rate: 4000, endSample: 99999 }],
};

// Simulate DAT file data (non-uniform timestamps)
const datFileTimestamps = [0, 1, 2, 6, 7, 8, 10]; // Non-uniform!
const iaData = [10, 12, 14, 18, 20, 22, 25];

console.log("\nðŸ“ DAT File Timestamps (non-uniform):");
console.log("  ", datFileTimestamps);

// Calculate uniform timestamps
const uniformTimestamps = generateUniformTimeArray(
  datFileTimestamps.length,
  cfg.samplingRates
);
console.log("\nâœ¨ Calculated Uniform Timestamps:");
console.log(
  "  ",
  uniformTimestamps.map((t) => t.toFixed(6))
);

// Compare
const comp = compareTimestamps(datFileTimestamps, uniformTimestamps);
console.log("\nðŸ“Š Comparison Analysis:");
console.log("  Has Gaps:", comp.hasGaps);
console.log("  Max Gap:", comp.maxGap.toFixed(6));

// Interpolate data
const newTimestamps = generateUniformTimeArray(7, cfg.samplingRates);
const interpolatedIA = interpolateData(
  datFileTimestamps,
  iaData,
  newTimestamps
);

console.log("\nðŸ”„ Data Interpolation:");
console.log("  Original IA Data:", iaData);
console.log(
  "  Interpolated IA:",
  interpolatedIA.map((v) => v.toFixed(2))
);

// Detect uniformity
const uniformityCheck = detectUniformSpacing(uniformTimestamps);
console.log("\nðŸŽ¯ Uniformity Check:");
console.log("  Is Uniform:", uniformityCheck.isUniform);
console.log(
  "  Avg Interval:",
  uniformityCheck.avgInterval.toFixed(6),
  "seconds"
);
console.log(
  "  Max Deviation:",
  uniformityCheck.maxDeviation.toFixed(9),
  "seconds"
);
</code></pre>
        </article>
    </section>




            </div>
            
            <footer class="footer">
                <div class="content has-text-centered">
                    <p>Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.5</a></p>
                    <p class="sidebar-created-by">
                        <a href="https://github.com/SoftwareBrothers/better-docs" target="_blank">BetterDocs theme</a> provided with <i class="fas fa-heart"></i> by
                        <a href="http://softwarebrothers.co" target="_blank">SoftwareBrothers - JavaScript Development Agency</a>
                    </p>
                </div>
            </footer>
            
        </div>
        <div id="side-nav" class="side-nav">
        </div>
    </div>
<script src="scripts/app.min.js"></script>
<script>PR.prettyPrint();</script>
<script src="scripts/linenumber.js"> </script>


</body>
</html>
